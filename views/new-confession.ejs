<%- include('partials/header') %>

<div class="container">
  <% if (error) { %>
    <div class="alert alert-error">
      <i class="fas fa-exclamation-circle"></i>
      <span><%= error %></span>
    </div>
  <% } %>
  
  <% if (success) { %>
    <div class="alert alert-success">
      <i class="fas fa-check-circle"></i>
      <span><%= success %></span>
    </div>
  <% } %>

  <div class="page-header">
    <h1>
      <i class="fas fa-pen-fancy"></i>
      Share Your Confession
    </h1>
    <p class="subtitle">Your identity remains completely anonymous</p>
  </div>

  <div class="form-container">
    <div class="form-card">
      <div class="form-icon">
        <i class="fas fa-lock"></i>
      </div>
      
      <form action="/confessions" method="POST" class="confession-form">
        <div class="form-group">
          <label for="text">
            <i class="fas fa-comment-dots"></i>
            Your Confession
          </label>
          <textarea 
            id="text"
            name="text" 
            placeholder="Share what's on your mind... No one will know it's you." 
            required
            maxlength="500"
            rows="8"
          ></textarea>
          <div class="char-counter">
            <span id="charCount">0</span> / 500 characters
          </div>
        </div>

        <div class="form-group">
          <label for="secretCode">
            <i class="fas fa-key"></i>
            Secret Code
          </label>
          <input 
            type="password" 
            id="secretCode"
            name="secretCode" 
            placeholder="Create a secret code (min 4 characters)" 
            minlength="4" 
            required
          >
          <small class="form-hint">
            <i class="fas fa-info-circle"></i>
            Remember this code! You'll need it to edit or delete your confession later.
          </small>
        </div>

        <div class="info-box">
          <i class="fas fa-shield-alt"></i>
          <div>
            <strong>Your Privacy is Protected</strong>
            <p>Your confession will be posted anonymously. Only you can edit or delete it using your secret code.</p>
          </div>
        </div>

        <button type="submit" class="btn btn-primary btn-large">
          <i class="fas fa-paper-plane"></i>
          Post Confession Anonymously
        </button>
      </form>
    </div>

    <div class="tips-card">
      <h3>
        <i class="fas fa-lightbulb"></i>
        Tips for Confessing
      </h3>
      <ul class="tips-list">
        <li>
          <i class="fas fa-check"></i>
          Be honest and authentic
        </li>
        <li>
          <i class="fas fa-check"></i>
          Respect others in your confession
        </li>
        <li>
          <i class="fas fa-check"></i>
          Remember your secret code
        </li>
        <li>
          <i class="fas fa-check"></i>
          Keep it under 500 characters
        </li>
        <li>
          <i class="fas fa-check"></i>
          Your identity stays anonymous
        </li>
      </ul>
    </div>
  </div>
</div>

<script>
  const textarea = document.getElementById('text');
  const charCount = document.getElementById('charCount');
  
  textarea.addEventListener('input', function() {
    charCount.textContent = this.value.length;
    if (this.value.length > 450) {
      charCount.style.color = '#e74c3c';
    } else {
      charCount.style.color = '#667eea';
    }
  });
</script>

<%- include('partials/footer') %>
